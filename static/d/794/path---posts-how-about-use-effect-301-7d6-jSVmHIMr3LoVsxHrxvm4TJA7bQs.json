{"data":{"site":{"siteMetadata":{"author":{"name":"Tek Fun","contacts":{"twitter":"vancuong279"}},"disqusShortname":"","subtitle":"I am a web developer. I love Javascript, ReactJS. With passion, curiosity, I learn for food, work for fun and share for the future. ","title":"Blog by Tek Fun","url":"https://tek-fun.netlify.com"}},"markdownRemark":{"id":"21e5ad21-5c44-518b-a9b1-c91c48541d4f","html":"<p>Trong Hooks có nhiều methods nhưng ở đây mình sẽ chỉ nói về thằng <strong>useEffect</strong>, vì thằng này nó thú vị và khôn lường lắm, cũng bởi vì thế mà nhiều vấn đề đau đầu vì nó nếu chúng ta không hiểu rõ về nó.</p>\n<h3 id=\"tôi-đã-thay-componentdidmount-bởi-useeffect-thế-nào\"><a href=\"#t%C3%B4i-%C4%91%C3%A3-thay-componentdidmount-b%E1%BB%9Fi-useeffect-th%E1%BA%BF-n%C3%A0o\" aria-label=\"tôi đã thay componentdidmount bởi useeffect thế nào permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tôi đã thay ComponentDidMount bởi useEffect thế nào:</h3>\n<p><code class=\"language-text\">useEffect(fn, [])</code> đó là cách tôi thay thế <strong>ComponentDidMount()</strong>, Với cách viết như vầy parameter đầu tiên sẽ là một function, trong function đó chúng ta có thể thực hiện những logic như fecth data, hay setState làm những thứ các bạn đã có thể làm được với *<em>ComponentDidMount</em>, parameter thứ 2 sẽ là một Array rỗng tếch. Chính vì thế mà nó sẽ chỉ chạy vào Effect này 1 lần duy nhất sau lần <code class=\"language-text\">render</code>  đầu tiền.</p>\n<p>Nhưng đưng code nhiều thứ quá ở nó nhé nhìn sẽ nổ mắt đấy =))</p>\n<h3 id=\"vậy-cái--cái-hộp-rỗng-tếch-mình-dùng-ở-trên-thì-nó-có-tác-dụng-gì\"><a href=\"#v%E1%BA%ADy-c%C3%A1i--c%C3%A1i-h%E1%BB%99p-r%E1%BB%97ng-t%E1%BA%BFch-m%C3%ACnh-d%C3%B9ng-%E1%BB%9F-tr%C3%AAn-th%C3%AC-n%C3%B3-c%C3%B3-t%C3%A1c-d%E1%BB%A5ng-g%C3%AC\" aria-label=\"vậy cái  cái hộp rỗng tếch mình dùng ở trên thì nó có tác dụng gì permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vậy cái [] (cái hộp rỗng tếch) mình dùng ở trên thì nó có tác dụng gì:</h3>\n<p>Với cái cách đặt <code class=\"language-text\">[]</code> đúng vị trí và không bỏ cái gì vào đó, sẽ làm cho effect này không sử dụng bất kỳ value vào tham gia vào quá trình xử lý data của React. Và đó là cách để nó chỉ thực hiện 1 lần duy nhất.</p>\n<p>Vậy nếu chúng ta ném vào trong cái cái hộp này <code class=\"language-text\">[]</code> vài giá trị thì sẽ thế nào nhỉ ? mình sẽ nói ở dưới sau :v</p>\n<h3 id=\"useeffect-lặp-vô-hạn--cái-này-chắc-ai-khi-bắt-đầu-sử-dụng-cũng-sẽ-bị-hoy\"><a href=\"#useeffect-l%E1%BA%B7p-v%C3%B4-h%E1%BA%A1n--c%C3%A1i-n%C3%A0y-ch%E1%BA%AFc-ai-khi-b%E1%BA%AFt-%C4%91%E1%BA%A7u-s%E1%BB%AD-d%E1%BB%A5ng-c%C5%A9ng-s%E1%BA%BD-b%E1%BB%8B-hoy\" aria-label=\"useeffect lặp vô hạn  cái này chắc ai khi bắt đầu sử dụng cũng sẽ bị hoy permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useEffect lặp vô hạn (???) cái này chắc ai khi bắt đầu sử dụng cũng sẽ bị hoy:</h3>\n<p>Lấy 1 ví dụ nhé, khi chúng ta thực hiện fetching data trong useEffect và không đưa và parameter thứ 2, <code class=\"language-text\">useEffect(fn)</code>. và trong effect này cũng ta thực hiện việc set một value sẽ được dùng trong data flow của component. thì nó sẽ xuất hiện ngay error.\nHoặc một trường hợp khác bạn ném vào trong cái <code class=\"language-text\">[]</code> này, những value luôn thay đổi, thì cái effect nãy sẽ loop mãi cho mà xem.</p>\n<p>OK! vậy ở đây chúng ta sẽ có 2 cách để làm việc với useEffect nữa:</p>\n<ul>\n<li><code class=\"language-text\">useEffect(fn)</code> không đưa vào [], thì effect này sẽ thực hiện liên tục mỗi khi component được render.</li>\n<li><code class=\"language-text\">useEffect(fn, [...value]);</code> đưa value vào mình dùng … để nói là nó có thể là nhiều value nhé, kể cả là function luôn :v. với cách này thì effect sẽ thực hiện mỗi khi có ít nhất một value được thay đổi. thấy có thể thay thế <code class=\"language-text\">ComponetDidUpdate</code> không ? không hẳn đâu nhé. :v</li>\n</ul>\n<h3 id=\"bàn-về-rendering-trong-react-để-rõ-hơn-về-bản-ngã-của-useeffect\"><a href=\"#b%C3%A0n-v%E1%BB%81-rendering-trong-react-%C4%91%E1%BB%83-r%C3%B5-h%C6%A1n-v%E1%BB%81-b%E1%BA%A3n-ng%C3%A3-c%E1%BB%A7a-useeffect\" aria-label=\"bàn về rendering trong react để rõ hơn về bản ngã của useeffect permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bàn về rendering trong react để rõ hơn về bản ngã của useEffect</h3>\n<p>Trước khi tiếp tục với <strong>useEffect</strong> chúng ta sẽ tìm hiểu chút về việc React rendering component nhưng thế nào với <code class=\"language-text\">props`` và</code>state`<code class=\"language-text\"></code> . Cái này khá mà phức tạo nên Khá bãnh cũng khá đuối :v.</p>\n<p>Vậy nên những chia sẽ tiếp theo sẽ là trải nghiệm và góp nhặt của tôi mang tới cho các bạn để hiểu rõ hơn. (Đừng phán xét tôi nhé) =))</p>\n<p>Now, hãy xem chúng ta có gì ở những dòng code này</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>You clicked <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span> times<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Click me\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>chúng ta có <strong>count</strong> đơn giản chỉ là ‘con số 0’ không có gì magic ở đây, và khi chúng ta click thì <strong>count</strong> đó sẽ change, và component sẽ re-render.\nMỗi lần click thì <strong>count</strong> được trả về từ <strong>useState()</strong> sẽ là 0, 1, 2, rồi tiếp theo đó …\nVà chúng ta có thể thấy rằng <strong>count</strong> là một <code class=\"language-text\">const</code> tại mỗi lần render của component, vì thế chúng ta biết rằng <strong>count</strong> bên trong mỗi lần render sẽ không thể thay đổi.</p>\n<h3 id=\"vậy-thì-mỗi-lần-render-với-handle-event-sẽ-thế-nào-\"><a href=\"#v%E1%BA%ADy-th%C3%AC-m%E1%BB%97i-l%E1%BA%A7n-render-v%E1%BB%9Bi-handle-event-s%E1%BA%BD-th%E1%BA%BF-n%C3%A0o-\" aria-label=\"vậy thì mỗi lần render với handle event sẽ thế nào  permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vậy thì mỗi lần render với handle event sẽ thế nào ?</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleAlertClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You clicked on: '</span> <span class=\"token operator\">+</span> count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>You clicked <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span> times<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Click me\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleAlertClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Show alert\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Nhìn vào những dòng code trên chúng ta có gì? chúng ta sẽ có 1 alert message được phóng ra sau 3s khi click button.\nHãy xem cụ thể hơn nào, bất code <a href=\"https://codesandbox.io\">https://codesandbox.io</a> lên nào, right now!</p>\n<p>làm theo cái tôi mô tả :</p>\n<ul>\n<li>click vào button <strong>click me</strong> 3 lần.</li>\n<li>click vào button <strong>show alert</strong> ngay.</li>\n<li>lại click ngay <strong>click me</strong> thêm 2 lần nữa.</li>\n</ul>\n<p>rồi đoán xem cái alert message sẽ là gì ? À mà cái vì dụ này tôi cũng có ở bài trước để phân tích Class và Function <a href=\"https://tek-fun.netlify.com/posts/how-are-function-component-different-from-classes/\">xem ở đây nào</a></p>\n<p>Ok! kết quả là 3 đúng ko nào, Nhưng tại sao lại là 3 mà không phải là số khác. Mổ xẻ nó ra nào !</p>\n<p>Như đã nói ở trên <strong>count</strong> là một constant vậy nên giá trị của nó tại mỗi lần call function cụ thể sẽ không hề thay đổi.\nThêm 1 ví dụ nữa nhé</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  <span class=\"token keyword\">function</span> <span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> person<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello, '</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">let</span> someone <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Dan'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span>someone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  someone <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Yuzhi'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span>someone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  someone <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Dominic'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span>someone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>với value <strong>someone</strong> luôn thay đổi sau mỗi lần gọi <strong>sayHi</strong> function, thì <strong>name</strong> bên trong của mỗi function <strong>sayHi</strong> cũng sẽ không hề thay.</p>\n<p>Như vậy đã giải thích cách event handle xử lý <strong>count</strong> tại mỗi lần click. vào đó là lý cho tại sao chúng ta có click thêm thì việc xử lý giá trị tại mỗi event handle là 1 giá trị cụ thể không thay đổi tại mỗi lần.</p>\n<h3 id=\"vậy-mỗi-lần-render-thì-các-effect-của-nó-như-thê-nào-\"><a href=\"#v%E1%BA%ADy-m%E1%BB%97i-l%E1%BA%A7n-render-th%C3%AC-c%C3%A1c-effect-c%E1%BB%A7a-n%C3%B3-nh%C6%B0-th%C3%AA-n%C3%A0o-\" aria-label=\"vậy mỗi lần render thì các effect của nó như thê nào  permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vậy mỗi lần Render thì các effect của nó như thê nào ?</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>You clicked <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span> times<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Click me\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Chúng ta biết rằng userEffect sẽ thực hiện sau mỗi lần component render. vì thế giá trị <strong>count</strong> cũng sẽ thuộc về mỗi effect sau mỗi lần render.\nNhư vậy chúng ta có thể thấy răng <strong>useEffect</strong> nhưng một phần cụ thể tại thuộc về mỗi lần render khác nhau của Component.</p>\n<h3 id=\"vậy-thì-props-và-state-tại-mỗi-lần-render-sẽ-thế-nào-\"><a href=\"#v%E1%BA%ADy-th%C3%AC-props-v%C3%A0-state-t%E1%BA%A1i-m%E1%BB%97i-l%E1%BA%A7n-render-s%E1%BA%BD-th%E1%BA%BF-n%C3%A0o-\" aria-label=\"vậy thì props và state tại mỗi lần render sẽ thế nào  permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vậy thì props và state tại mỗi lần render sẽ thế nào ?</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>You clicked <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span> times<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Click me\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>thực hiện đoạn code trên và show logs chúng ta thấy nó vẫn thể hiện đúng như những phân tích ở trên.</p>\n<p>Nhưng nếu chúng ta thử nó trong Class component thì sẽ thế nào <code class=\"language-text\">this.state</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>với cách này chúng ta sẽ thấy nó show console <strong>count</strong> cuối cùng, không còn là giá trị cụ thể tại mỗi lần render nữa.\nNhư thế khi sử dụng `<code class=\"language-text\">this.state.count</code> chúng ta luôn nhận được giá trị cuối cùng.</p>\n<p>Nhưng một vài trường hợp nào đó, chúng ta lại muốn lây giá trị cuối cùng của props hoặc state thì sao? Cách đơn giản là sử dụng <strong>refs</strong>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> latestCount <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Set the mutable latest value</span>\n    latestCount<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> count<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Read the mutable latest value</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>latestCount<span class=\"token punctuation\">.</span>current<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Và đây là cách chúng ta lấy state mới nhật tại mỗi render và useEffect tại mỗi lần render.</p>\n<h3 id=\"vậy-đâu-là-cái-cách-mà-react-render-lại-component-và-làm-tăng-perfomance\"><a href=\"#v%E1%BA%ADy-%C4%91%C3%A2u-l%C3%A0-c%C3%A1i-c%C3%A1ch-m%C3%A0-react-render-l%E1%BA%A1i-component-v%C3%A0-l%C3%A0m-t%C4%83ng-perfomance\" aria-label=\"vậy đâu là cái cách mà react render lại component và làm tăng perfomance permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vậy đâu là cái cách mà React render lại Component và làm tăng perfomance?</h3>\n<p>Như chúng ta đã biết, React thay vì re-render mọi thứ, thì nó chỉ re-render những phần thay đổi của DOM.</p>\n<p>chúng ta thay đổi từ</p>\n<div class=\"gatsby-highlight\" data-language=\"javascrtip\"><pre class=\"language-javascrtip\"><code class=\"language-javascrtip\">&lt;Counter className=&quot;blue&quot;&gt;this is counter&lt;/Counter&gt;</code></pre></div>\n<p>thành</p>\n<div class=\"gatsby-highlight\" data-language=\"javascrtip\"><pre class=\"language-javascrtip\"><code class=\"language-javascrtip\">&lt;Counter className=&quot;blue&quot;&gt;this is example&lt;/Counter&gt;</code></pre></div>\n<p>React sẽ nhìn phần được 2 Object</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> oldProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span> children<span class=\"token punctuation\">:</span> <span class=\"token string\">'this is counter'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span> children<span class=\"token punctuation\">:</span> <span class=\"token string\">'this is example'</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>thì cái thay đổi cho là children chứ ko phải className, Vậy nên nó chỉ thay đổi</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">domNode.innerText = &#39;this is example&#39;;</code></pre></div>\n<p>Vậy nên trong useEffect để tránh việc thực hiện việc chạy lại những function không cần thiết, chúng ta cần xác định dựa vào việc đưa vào cái [], những dependencies cụ thể.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Greeting</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>counter<span class=\"token punctuation\">,</span> setCounter<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'Hello, '</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token string\">\"Greeting\"</span><span class=\"token operator\">></span>\n      Hello<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCounter</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Increment\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>với code trên thì useEffect sẽ luôn chạy lại sau mỗi lần re-render khi change count, trong khi đó useEffect không hề xử lý logic gì đến nó.\nĐể giải quyêt điều đó chúng ta sẽ thực hiện lại</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'Hello, '</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Như Vậy useEffect này chỉ chạy lại khi props name thay đổi mà thôi.</p>\n<p>Hazz! Nội dung chia sẽ về thằng này còn rất là nhiều, nên mình sẽ viết thêm ở bài sau. giờ thì đau lưng rồi, xin phép dừng ở đây nhé.\nBài sau sẽ ra lò ngày mọi người sẽ không phải đợi lâu :vs</p>\n<p>Thank you for your reading!</p>","fields":{"slug":"/posts/how-about-useEffect/","tagSlugs":["/tag/javascript/","/tag/react-js/","/tag/hooks/"]},"frontmatter":{"date":"2019-06-10T23:46:37.121Z","description":"Bắt đầu từ version 16.8.xx React Team của Facebook đã đưa ra Hooks một số function mới và theo bản thân mình thì nó làm thay đổi khá nhiều về cách code 1 Component, cũng chạy theo trend nên mình cũng đã áp dụng vào một vài dự án và thấy một vài trải nghiệm thú vị nên viết bài này để chia sẽ một vài trải nghiệm của mình với 1 effect trong Hooks là useEffect","tags":["Javascript","ReactJS","Hooks"],"title":"How about useEffect in Hooks."}}},"pageContext":{"slug":"/posts/how-about-useEffect/"}}